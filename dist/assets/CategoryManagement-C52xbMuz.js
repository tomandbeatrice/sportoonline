import{d as U,r as u,c as w,o as R,e as o,f as n,g as e,h as z,t as i,i as A,O as B,n as x,F as K,k as $,M as q,z as G,p as H,q as r,v,P as J,G as Q,D as g}from"./index-D2hY-dD-.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"category-management"},Z={class:"stats-cards"},ee={class:"stat-card"},te={class:"stat-content"},se={class:"stat-value"},ae={class:"stat-card"},le={class:"stat-icon"},ne={class:"stat-content"},ie={class:"stat-value"},oe={class:"stat-card"},de={class:"stat-content"},re={class:"stat-value"},ue={class:"stat-card"},ce={class:"stat-icon"},ve={class:"stat-content"},pe={class:"stat-value"},me={class:"categories-container"},ge={class:"tree-header"},_e={class:"view-toggle"},be={key:0,class:"tree-view"},fe={key:0,class:"loading-message"},ke={key:1,class:"empty-message"},he={key:2,class:"category-tree"},ye={key:1,class:"list-view"},Ce={class:"categories-table"},we={key:0},xe={key:1},Ke={class:"category-info"},$e={key:0,class:"category-icon"},Me={class:"category-name"},Ee={class:"badge-count"},Se={class:"action-buttons"},Ve=["onClick"],ze=["onClick"],Ae=["onClick"],Be={class:"modal-content"},Ue={class:"modal-header"},De={class:"modal-body"},Ne={class:"form-group"},Oe={class:"form-group"},Te={class:"form-group"},Ye=["value","disabled"],Le={class:"form-group"},Pe={class:"form-group"},je={class:"form-row"},Fe={class:"form-group"},Ie={class:"form-group"},Re={class:"toggle-switch"},qe={for:"is_active"},Ge={class:"form-group"},He={class:"form-group"},Je={class:"modal-footer"},Qe=["disabled"],We=U({name:"CategoryNode",props:{category:{type:Object,required:!0},level:{type:Number,default:0}},emits:["edit","delete","toggle-status"],setup(D,{emit:p}){const c=u(!0);return{expanded:c,toggleExpand:()=>{c.value=!c.value}}},template:`
    <div class="tree-node">
      <div class="node-content" :style="{ paddingLeft: (level * 2) + 'rem' }">
        <button 
          v-if="category.children && category.children.length > 0" 
          @click="toggleExpand"
          class="expand-btn"
        >
          {{ expanded ? 'â–¼' : 'â–¶' }}
        </button>
        <span v-else class="expand-spacer"></span>
        
        <div class="node-info">
          <span v-if="category.icon" class="node-icon">{{ category.icon }}</span>
          <span class="node-name">{{ category.name }}</span>
          <span class="node-count">({{ category.products_count || 0 }})</span>
          <span :class="['node-status', category.is_active ? 'active' : 'inactive']">
            {{ category.is_active ? 'âœ“' : 'âœ—' }}
          </span>
        </div>

        <div class="node-actions">
          <button @click="$emit('edit', category)" class="btn-action btn-edit">âœï¸</button>
          <button @click="$emit('toggle-status', category)" class="btn-action btn-toggle">
            {{ category.is_active ? 'â¸ï¸' : 'â–¶ï¸' }}
          </button>
          <button @click="$emit('delete', category)" class="btn-action btn-delete">ğŸ—‘ï¸</button>
        </div>
      </div>

      <div v-if="expanded && category.children && category.children.length > 0" class="node-children">
        <CategoryNode
          v-for="child in category.children"
          :key="child.id"
          :category="child"
          :level="level + 1"
          @edit="$emit('edit', $event)"
          @delete="$emit('delete', $event)"
          @toggle-status="$emit('toggle-status', $event)"
        />
      </div>
    </div>
  `}),Xe=U({__name:"CategoryManagement",setup(D){const p=u([]),c=u(!1),_=u(!1),m=u(!1),h=u(!1),b=u("tree"),f=u({total:0,active:0,parents:0,totalProducts:0}),l=u({name:"",slug:"",parent_id:null,icon:"",description:"",order:0,is_active:!0,meta_title:"",meta_description:""}),N=w(()=>p.value.filter(a=>!a.parent_id)),M=w(()=>p.value),O=w(()=>p.value.filter(a=>!a.parent_id||a.id!==l.value.id)),T=a=>new Intl.NumberFormat("tr-TR").format(a),Y=()=>{if(!l.value.name)return;const a={Ã§:"c",Ã‡:"c",ÄŸ:"g",Ä:"g",Ä±:"i",Ä°:"i",Ã¶:"o",Ã–:"o",ÅŸ:"s",Å:"s",Ã¼:"u",Ãœ:"u"};let t=l.value.name.toLowerCase();Object.keys(a).forEach(s=>{t=t.replace(new RegExp(s,"g"),a[s])}),t=t.replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),l.value.slug=t},k=async()=>{c.value=!0;try{const{data:a}=await g.get("/api/admin/categories");p.value=L(a),P()}catch(a){console.error("Kategoriler yÃ¼klenemedi:",a)}finally{c.value=!1}},L=a=>{const t=new Map,s=[];return a.forEach(d=>{t.set(d.id,{...d,children:[]})}),t.forEach(d=>{if(d.parent_id){const C=t.get(d.parent_id);C&&(C.children=C.children||[],C.children.push(d))}else s.push(d)}),s},P=async()=>{try{const{data:a}=await g.get("/api/admin/categories/stats");f.value=a}catch(a){console.error("Ä°statistikler yÃ¼klenemedi:",a)}},j=()=>{m.value=!1,l.value={name:"",slug:"",parent_id:null,icon:"",description:"",order:0,is_active:!0,meta_title:"",meta_description:""},_.value=!0},E=a=>{m.value=!0,l.value={id:a.id,name:a.name,slug:a.slug,parent_id:a.parent_id,icon:a.icon,description:a.description,order:a.order||0,is_active:a.is_active,meta_title:a.meta_title,meta_description:a.meta_description},_.value=!0},y=()=>{_.value=!1,l.value={}},F=async()=>{if(!l.value.name||!l.value.slug){alert("Kategori adÄ± ve slug zorunludur");return}h.value=!0;try{m.value?await g.put(`/api/admin/categories/${l.value.id}`,l.value):await g.post("/api/admin/categories",l.value),y(),await k()}catch(a){console.error("Kategori kaydedilemedi:",a),alert(a.response?.data?.message||"Bir hata oluÅŸtu")}finally{h.value=!1}},S=async a=>{try{await g.put(`/api/admin/categories/${a.id}`,{is_active:!a.is_active}),await k()}catch(t){console.error("Durum gÃ¼ncellenemedi:",t),alert("Bir hata oluÅŸtu")}},V=async a=>{if(a.products_count&&a.products_count>0){alert("Bu kategoride Ã¼rÃ¼n bulunduÄŸu iÃ§in silemezsiniz. Ã–nce Ã¼rÃ¼nleri taÅŸÄ±yÄ±n.");return}if(a.children&&a.children.length>0){alert("Bu kategorinin alt kategorileri var. Ã–nce alt kategorileri silin.");return}if(confirm(`"${a.name}" kategorisini silmek istediÄŸinizden emin misiniz?`))try{await g.delete(`/api/admin/categories/${a.id}`),await k()}catch(t){console.error("Kategori silinemedi:",t),alert("Bir hata oluÅŸtu")}},I=()=>{k()};return R(()=>{k()}),(a,t)=>(n(),o("div",X,[e("div",{class:"page-header"},[t[11]||(t[11]=e("div",{class:"header-left"},[e("h1",null,"ğŸ“ Kategori YÃ¶netimi"),e("p",{class:"subtitle"},"ÃœrÃ¼n kategorilerini yÃ¶netin")],-1)),e("div",{class:"header-actions"},[e("button",{onClick:I,class:"btn-refresh"},"ğŸ”„ Yenile"),e("button",{onClick:j,class:"btn-create"},"â• Yeni Kategori")])]),e("div",Z,[e("div",ee,[t[13]||(t[13]=e("div",{class:"stat-icon"},"ğŸ“",-1)),e("div",te,[e("div",se,i(f.value.total),1),t[12]||(t[12]=e("div",{class:"stat-label"},"Toplam Kategori",-1))])]),e("div",ae,[e("div",le,[A(B,{name:"check",cls:"w-6 h-6 text-green-600"})]),e("div",ne,[e("div",ie,i(f.value.active),1),t[14]||(t[14]=e("div",{class:"stat-label"},"Aktif Kategori",-1))])]),e("div",oe,[t[16]||(t[16]=e("div",{class:"stat-icon"},"ğŸŒ³",-1)),e("div",de,[e("div",re,i(f.value.parents),1),t[15]||(t[15]=e("div",{class:"stat-label"},"Ana Kategori",-1))])]),e("div",ue,[e("div",ce,[A(B,{name:"box",cls:"w-6 h-6 text-blue-600"})]),e("div",ve,[e("div",pe,i(T(f.value.totalProducts)),1),t[17]||(t[17]=e("div",{class:"stat-label"},"Toplam ÃœrÃ¼n",-1))])])]),e("div",me,[e("div",ge,[t[18]||(t[18]=e("h2",null,"ğŸŒ³ Kategori AÄŸacÄ±",-1)),e("div",_e,[e("button",{class:x(["toggle-btn",{active:b.value==="tree"}]),onClick:t[0]||(t[0]=s=>b.value="tree")}," ğŸŒ³ AÄŸaÃ§ ",2),e("button",{class:x(["toggle-btn",{active:b.value==="list"}]),onClick:t[1]||(t[1]=s=>b.value="list")}," ğŸ“‹ Liste ",2)])]),b.value==="tree"?(n(),o("div",be,[c.value?(n(),o("div",fe,"â³ YÃ¼kleniyor...")):p.value.length===0?(n(),o("div",ke," ğŸ˜• Kategori bulunamadÄ± ")):(n(),o("div",he,[(n(!0),o(K,null,$(N.value,s=>(n(),q(G(We),{key:s.id,category:s,level:0,onEdit:E,onDelete:V,onToggleStatus:S},null,8,["category"]))),128))]))])):(n(),o("div",ye,[e("table",Ce,[t[21]||(t[21]=e("thead",null,[e("tr",null,[e("th",null,"Kategori"),e("th",null,"Slug"),e("th",null,"Ãœst Kategori"),e("th",null,"ÃœrÃ¼n SayÄ±sÄ±"),e("th",null,"Durum"),e("th",null,"SÄ±ra"),e("th",null,"Ä°ÅŸlemler")])],-1)),e("tbody",null,[c.value?(n(),o("tr",we,[...t[19]||(t[19]=[e("td",{colspan:"7",class:"loading-cell"},"â³ YÃ¼kleniyor...",-1)])])):M.value.length===0?(n(),o("tr",xe,[...t[20]||(t[20]=[e("td",{colspan:"7",class:"empty-cell"},"ğŸ˜• Kategori bulunamadÄ±",-1)])])):(n(!0),o(K,{key:2},$(M.value,s=>(n(),o("tr",{key:s.id},[e("td",null,[e("div",Ke,[s.icon?(n(),o("span",$e,i(s.icon),1)):z("",!0),e("span",Me,i(s.name),1)])]),e("td",null,i(s.slug),1),e("td",null,i(s.parent?.name||"-"),1),e("td",null,[e("span",Ee,i(s.products_count||0),1)]),e("td",null,[e("span",{class:x(["status-badge",s.is_active?"active":"inactive"])},i(s.is_active?"Aktif":"Pasif"),3)]),e("td",null,i(s.order||0),1),e("td",null,[e("div",Se,[e("button",{onClick:d=>E(s),class:"btn-action btn-edit"},"âœï¸",8,Ve),e("button",{onClick:d=>S(s),class:"btn-action btn-toggle"},i(s.is_active?"â¸ï¸":"â–¶ï¸"),9,ze),e("button",{onClick:d=>V(s),class:"btn-action btn-delete"},"ğŸ—‘ï¸",8,Ae)])])]))),128))])])]))]),_.value?(n(),o("div",{key:0,class:"modal-overlay",onClick:H(y,["self"])},[e("div",Be,[e("div",Ue,[e("h2",null,i(m.value?"âœï¸ Kategori DÃ¼zenle":"â• Yeni Kategori"),1),e("button",{onClick:y,class:"btn-close"},"âœ•")]),e("div",De,[e("div",Ne,[t[22]||(t[22]=e("label",null,"Kategori AdÄ± *",-1)),r(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.name=s),type:"text",placeholder:"Ã–rn: Spor AyakkabÄ±larÄ±",onInput:Y},null,544),[[v,l.value.name]])]),e("div",Oe,[t[23]||(t[23]=e("label",null,"Slug *",-1)),r(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.value.slug=s),type:"text",placeholder:"spor-ayakkabilari"},null,512),[[v,l.value.slug]]),t[24]||(t[24]=e("small",null,"URL'de kullanÄ±lacak benzersiz isim",-1))]),e("div",Te,[t[26]||(t[26]=e("label",null,"Ãœst Kategori",-1)),r(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.parent_id=s)},[t[25]||(t[25]=e("option",{value:null},"Ana Kategori",-1)),(n(!0),o(K,null,$(O.value,s=>(n(),o("option",{key:s.id,value:s.id,disabled:m.value&&s.id===l.value.id},i(s.name),9,Ye))),128))],512),[[J,l.value.parent_id]])]),e("div",Le,[t[27]||(t[27]=e("label",null,"Ä°kon (Emoji)",-1)),r(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.icon=s),type:"text",placeholder:"âš½",maxlength:"2"},null,512),[[v,l.value.icon]])]),e("div",Pe,[t[28]||(t[28]=e("label",null,"AÃ§Ä±klama",-1)),r(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.value.description=s),rows:"3",placeholder:"Kategori aÃ§Ä±klamasÄ±..."},null,512),[[v,l.value.description]])]),e("div",je,[e("div",Fe,[t[29]||(t[29]=e("label",null,"SÄ±ra",-1)),r(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>l.value.order=s),type:"number",min:"0"},null,512),[[v,l.value.order,void 0,{number:!0}]])]),e("div",Ie,[t[30]||(t[30]=e("label",null,"Durum",-1)),e("div",Re,[r(e("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=s=>l.value.is_active=s),id:"is_active"},null,512),[[Q,l.value.is_active]]),e("label",qe,i(l.value.is_active?"Aktif":"Pasif"),1)])])]),e("div",Ge,[t[31]||(t[31]=e("label",null,"Meta BaÅŸlÄ±k (SEO)",-1)),r(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>l.value.meta_title=s),type:"text",placeholder:"SEO iÃ§in sayfa baÅŸlÄ±ÄŸÄ±"},null,512),[[v,l.value.meta_title]])]),e("div",He,[t[32]||(t[32]=e("label",null,"Meta AÃ§Ä±klama (SEO)",-1)),r(e("textarea",{"onUpdate:modelValue":t[10]||(t[10]=s=>l.value.meta_description=s),rows:"2",placeholder:"SEO iÃ§in sayfa aÃ§Ä±klamasÄ±..."},null,512),[[v,l.value.meta_description]])])]),e("div",Je,[e("button",{onClick:y,class:"btn-secondary"},"Ä°ptal"),e("button",{onClick:F,class:"btn-primary",disabled:h.value},i(h.value?"â³ Kaydediliyor...":m.value?"ğŸ’¾ GÃ¼ncelle":"â• OluÅŸtur"),9,Qe)])])])):z("",!0)]))}}),tt=W(Xe,[["__scopeId","data-v-7cfea480"]]);export{We as CategoryNode,tt as default};
