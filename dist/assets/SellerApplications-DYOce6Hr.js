import{d as Q,r as g,c as v,o as U,e as u,f as o,g as t,i as n,w as l,z as r,j as c,t as d,F as y,k as b,M as W,n as A,h as f,p as X,T as Y,ah as D}from"./index-BGyiXXhD.js";import{_ as k,a as h,b as w,c as B,d as C,e as Z}from"./Alert.vue_vue_type_script_setup_true_lang-BrAK_WXF.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"bg-slate-50 px-4 py-10 md:px-8"},ae={class:"mb-8 grid gap-6 lg:grid-cols-[1.4fr_0.8fr]"},se={class:"text-xs uppercase tracking-[0.4em] text-white/60"},le={class:"text-4xl font-semibold"},ne={class:"text-sm text-white/70"},re={class:"flex flex-wrap gap-2"},oe=["onClick"],ie={key:0,class:"ml-2 rounded-full bg-black/10 px-2 py-0.5 text-[10px]"},ue={key:0,class:"flex min-h-[240px] items-center justify-center text-slate-500"},de={key:1},ce={class:"overflow-x-auto"},pe={class:"min-w-full text-left text-sm"},me={class:"px-4 py-4 text-sm font-semibold text-slate-900"},xe={class:"text-xs text-slate-400"},ve={class:"px-4 py-4 text-sm text-slate-500"},fe={class:"px-4 py-4 text-sm text-slate-900"},ye={class:"px-4 py-4 text-sm text-slate-500"},be={class:"px-4 py-4"},_e={class:"px-4 py-4 text-sm font-semibold"},ge={key:0,class:"flex flex-wrap gap-2"},ke=["onClick"],he=["onClick"],we=["onClick"],Be={key:1,class:"text-xs uppercase tracking-[0.3em] text-slate-400"},Ce={key:0,class:"py-16 text-center text-sm text-slate-500"},$e={class:"grid gap-6 md:grid-cols-2"},je={class:"text-xs uppercase tracking-[0.3em] text-slate-400"},Se={class:"text-sm font-semibold text-slate-900"},ze={class:"flex flex-wrap justify-end gap-3"},Oe=Q({__name:"SellerApplications",setup(Ae){const p=g([]),$=g(!0),i=g(null),_=g("all"),m=v(()=>p.value.reduce((s,a)=>(s[a.status]+=1,s),{pending:0,approved:0,rejected:0})),E=v(()=>[{id:"all",label:"Tümü",count:p.value.length},{id:"pending",label:"Bekleyen",count:m.value.pending},{id:"approved",label:"Onaylanan",count:m.value.approved},{id:"rejected",label:"Reddedilen",count:m.value.rejected}]),K=v(()=>[{id:"pending",label:"Bekleyen Başvuru",value:R(m.value.pending),hint:"Manuel inceleme bekleyen talep"},{id:"approved",label:"Son 7 Gün Çıkan",value:R(m.value.approved),hint:"Otomatik onaylanan satıcı"},{id:"sla",label:"Ortalama SLA",value:T,hint:"Başvurudan karara kadarki süre"}]),M=v(()=>_.value==="all"?p.value:p.value.filter(s=>s.status===_.value)),G=v(()=>{const s=m.value.pending,a=m.value.approved;return[{id:"pending",title:`${s} bekleyen başvuru`,description:s?"Operasyon kuyruğunu boşaltmak için manuel inceleme bekliyor.":"Bekleyen başvuru yok. Otomasyon çalışıyor.",variant:s>0?"orange":"emerald"},{id:"automation",title:"Otomatik onay motoru",description:a?`${a} başvuru otomatik olarak onaylandı.`:"Son 24 saatte otomatik onaylanan başvuru bulunmuyor.",variant:a>0?"emerald":"default"}]}),H=[{id:"user.name",label:"Satıcı Adı"},{id:"user.email",label:"E-posta"},{id:"name",label:"Mağaza"},{id:"business_description",label:"İş Açıklaması"},{id:"phone",label:"Telefon"},{id:"tax_number",label:"Vergi No"},{id:"address",label:"Adres"},{id:"bank_account",label:"Banka Hesabı"}],T=v(()=>{if(!p.value.length)return"—";const s=Date.now(),e=p.value.reduce((x,O)=>{const J=new Date(O.created_at).getTime();return x+Math.max(0,(s-J)/(1e3*60))},0)/p.value.length;return`${Math.max(1,Math.round(e))} dk`});function N(s){return{pending:"rounded-full bg-yellow-100 px-3 py-1 text-xs font-semibold text-yellow-800",approved:"rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700",rejected:"rounded-full bg-orange-100 px-3 py-1 text-xs font-semibold text-orange-700"}[s]}function j(s){return{pending:"Beklemede",approved:"Onaylandı",rejected:"Reddedildi"}[s]}function I(s){if(!i.value)return"—";let e=s.split(".").reduce((x,O)=>x?.[O],i.value);return(!e||e==="")&&s==="name"&&(e=i.value.store_name),e??"—"}function R(s){return new Intl.NumberFormat("tr-TR").format(s??0)}function P(s){return s?new Date(s).toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric"}):"—"}async function S(){$.value=!0;try{const{data:s}=await D.get("/admin/seller-applications");p.value=s,i.value&&(i.value=s.find(a=>a.id===i.value?.id)||null)}catch(s){console.error("Başvurular yüklenemedi:",s)}finally{$.value=!1}}function q(s){i.value=s}function z(){i.value=null}async function F(s){if(confirm("Bu başvuruyu onaylamak istediğinizden emin misiniz?"))try{await D.patch(`/admin/vendors/${s}/status`,{status:"approved"}),await S()}catch(a){console.error("Onaylama işlemi başarısız:",a),alert("Onay işlemi sırasında bir hata oluştu.")}}async function V(s){if(confirm("Bu başvuruyu reddetmek istediğinizden emin misiniz?"))try{await D.patch(`/admin/vendors/${s}/status`,{status:"rejected"}),await S()}catch(a){console.error("Reddetme işlemi başarısız:",a),alert("Red işlemi sırasında bir hata oluştu.")}}async function L(s){i.value&&(s==="approve"?await F(i.value.id):await V(i.value.id),z())}return U(S),(s,a)=>(o(),u("div",te,[t("section",ae,[n(r(C),{class:"bg-gradient-to-r from-indigo-900 via-violet-900 to-slate-900 text-white"},{default:l(()=>[n(r(k),{class:"flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between"},{default:l(()=>[t("div",null,[n(r(h),{class:"text-3xl"},{default:l(()=>[...a[3]||(a[3]=[c("Satıcı Başvuru Kokpiti",-1)])]),_:1}),n(r(w),{class:"text-white/70"},{default:l(()=>[c(" Başvuruların onay SLA'sı "+d(T.value)+". Şu an "+d(m.value.pending)+" bekleyen talep var. ",1)]),_:1})]),a[4]||(a[4]=t("div",{class:"flex flex-wrap gap-3"},[t("button",{class:"rounded-2xl border border-white/30 px-4 py-2 text-sm font-semibold text-white/80 transition hover:border-white hover:text-white"}," Kılavuzu Paylaş "),t("button",{class:"rounded-2xl bg-white px-5 py-2 text-sm font-semibold text-slate-900 shadow-lg shadow-slate-900/40 transition hover:-translate-y-[2px]"}," Otomatik Onay Akışı ")],-1))]),_:1}),n(r(B),{class:"grid gap-6 md:grid-cols-3"},{default:l(()=>[(o(!0),u(y,null,b(K.value,e=>(o(),u("div",{key:e.id,class:"space-y-2"},[t("p",se,d(e.label),1),t("p",le,d(e.value),1),t("p",ne,d(e.hint),1)]))),128))]),_:1})]),_:1}),n(r(C),null,{default:l(()=>[n(r(k),null,{default:l(()=>[n(r(h),null,{default:l(()=>[...a[5]||(a[5]=[c("İstikrar Notları",-1)])]),_:1}),n(r(w),null,{default:l(()=>[...a[6]||(a[6]=[c("Başvuru akışıyla ilgili öneriler",-1)])]),_:1})]),_:1}),n(r(B),{class:"space-y-4"},{default:l(()=>[(o(!0),u(y,null,b(G.value,e=>(o(),W(r(Z),{key:e.id,title:e.title,variant:e.variant},{default:l(()=>[c(d(e.description),1)]),_:2},1032,["title","variant"]))),128))]),_:1})]),_:1})]),t("section",null,[n(r(C),{class:"space-y-6"},{default:l(()=>[n(r(k),{class:"gap-4"},{default:l(()=>[t("div",null,[n(r(h),null,{default:l(()=>[...a[7]||(a[7]=[c("Başvuru Listesi",-1)])]),_:1}),n(r(w),null,{default:l(()=>[...a[8]||(a[8]=[c("Filtreleyerek bekleyen satıcıları hızla değerlendir.",-1)])]),_:1})]),t("div",re,[(o(!0),u(y,null,b(E.value,e=>(o(),u("button",{key:e.id,class:A(["rounded-2xl border px-4 py-2 text-xs font-semibold uppercase tracking-[0.3em] transition",_.value===e.id?"border-transparent bg-slate-900 text-white shadow":"border-slate-200 bg-white text-slate-500"]),onClick:x=>_.value=e.id},[c(d(e.label)+" ",1),e.count!==void 0?(o(),u("span",ie,d(e.count),1)):f("",!0)],10,oe))),128))])]),_:1}),n(r(B),null,{default:l(()=>[$.value?(o(),u("div",ue," Başvurular yükleniyor... ")):(o(),u("div",de,[t("div",ce,[t("table",pe,[a[9]||(a[9]=t("thead",null,[t("tr",{class:"text-xs uppercase tracking-[0.3em] text-slate-400"},[t("th",{class:"px-4 py-3"},"Satıcı"),t("th",{class:"px-4 py-3"},"E-posta"),t("th",{class:"px-4 py-3"},"Mağaza"),t("th",{class:"px-4 py-3"},"Başvuru"),t("th",{class:"px-4 py-3"},"Durum"),t("th",{class:"px-4 py-3"},"İşlem")])],-1)),t("tbody",null,[(o(!0),u(y,null,b(M.value,e=>(o(),u("tr",{key:e.id,class:"border-t border-slate-100"},[t("td",me,[c(d(e.user.name)+" ",1),t("p",xe,d(e.user.company_role||"—"),1)]),t("td",ve,d(e.user.email),1),t("td",fe,d(e.name||e.store_name||"—"),1),t("td",ye,d(P(e.created_at)),1),t("td",be,[t("span",{class:A(N(e.status))},d(j(e.status)),3)]),t("td",_e,[e.status==="pending"?(o(),u("div",ge,[t("button",{class:"text-slate-500 underline-offset-2 hover:text-slate-900 hover:underline",onClick:x=>q(e)}," Detay ",8,ke),t("button",{class:"text-emerald-600 hover:text-emerald-800",onClick:x=>F(e.id)}," Onayla ",8,he),t("button",{class:"text-orange-600 hover:text-orange-800",onClick:x=>V(e.id)}," Reddet ",8,we)])):(o(),u("span",Be,d(j(e.status)),1))])]))),128))])])]),M.value.length===0?(o(),u("div",Ce," Filtreye uygun başvuru bulunamadı. ")):f("",!0)]))]),_:1})]),_:1})]),n(Y,{name:"fade"},{default:l(()=>[i.value?(o(),u("div",{key:0,class:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/60 px-4 py-10",onClick:z},[n(r(C),{class:"max-h-[90vh] w-full max-w-3xl overflow-y-auto bg-white",onClick:a[2]||(a[2]=X(()=>{},["stop"]))},{default:l(()=>[n(r(k),{class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},{default:l(()=>[t("div",null,[n(r(h),null,{default:l(()=>[...a[10]||(a[10]=[c("Başvuru Detayları",-1)])]),_:1}),n(r(w),null,{default:l(()=>[c(d(i.value?.name||i.value?.store_name),1)]),_:1})]),i.value?(o(),u("span",{key:0,class:A(N(i.value.status))},d(j(i.value.status)),3)):f("",!0)]),_:1}),n(r(B),{class:"space-y-6"},{default:l(()=>[t("div",$e,[(o(),u(y,null,b(H,e=>t("div",{key:e.id},[t("p",je,d(e.label),1),t("p",Se,d(I(e.id)),1)])),64))]),t("div",ze,[t("button",{class:"rounded-2xl border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-600",onClick:z}," Kapat "),i.value?.status==="pending"?(o(),u("button",{key:0,class:"rounded-2xl bg-orange-100 px-4 py-2 text-sm font-semibold text-orange-700",onClick:a[0]||(a[0]=e=>L("reject"))}," Reddet ")):f("",!0),i.value?.status==="pending"?(o(),u("button",{key:1,class:"rounded-2xl bg-emerald-600 px-4 py-2 text-sm font-semibold text-white",onClick:a[1]||(a[1]=e=>L("approve"))}," Onayla ")):f("",!0)])]),_:1})]),_:1})])):f("",!0)]),_:1})]))}}),Ne=ee(Oe,[["__scopeId","data-v-ae755d5b"]]);export{Ne as default};
