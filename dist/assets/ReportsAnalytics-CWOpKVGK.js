import{d as Q,r as i,B as X,o as ee,R as K,D as h,S as te,e as d,f as c,g as e,F as m,k as p,n as g,t as a,q as k,v as O,j as S,P as se}from"./index-D2hY-dD-.js";import{C as b,r as ae}from"./chart-DUPVkyAx.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={class:"reports-analytics"},le={class:"header"},oe={class:"header-actions"},ie={class:"period-selector"},de=["onClick"],ce={class:"custom-range"},ue={class:"metrics-grid"},ve={class:"metric-card"},me={class:"metric-value"},pe={class:"metric-card"},he={class:"metric-value"},ge={class:"metric-card"},_e={class:"metric-value"},ye={class:"metric-card"},be={class:"metric-value"},fe={class:"charts-row"},Ce={class:"chart-card"},ke={class:"chart-header"},Se={class:"chart-container"},Re={class:"chart-card"},xe={class:"chart-container"},we={class:"charts-row"},De={class:"chart-card"},Ae={class:"chart-container"},Te={class:"chart-card"},Me={class:"chart-container"},Ge={class:"performers-section"},Be={class:"performers-card"},Oe={class:"performers-list"},Ee={class:"rank"},Ve={class:"performer-info"},Ue={class:"performer-stats"},Fe={class:"stat"},Ie={class:"stat"},Pe={class:"performers-card"},Ye={class:"performers-list"},$e={class:"rank"},Le={class:"performer-info"},Ke={class:"performer-stats"},Ne={class:"stat"},je={class:"stat"},ze={class:"tables-section"},We={class:"table-card"},Ze={class:"table-header"},qe={class:"table-actions"},He={class:"table-container"},Je={class:"summary-grid"},Qe={class:"summary-card"},Xe={class:"summary-list"},et={class:"summary-label"},tt={class:"summary-value"},st={class:"summary-percent"},at={class:"summary-card"},rt={class:"summary-list"},nt={class:"summary-label"},lt={class:"summary-value"},ot={class:"summary-percent"},it={class:"summary-card"},dt={class:"summary-list"},ct={class:"summary-label"},ut={class:"summary-value"},vt={class:"summary-percent"},mt=Q({__name:"ReportsAnalytics",setup(pt){b.register(...ae);const _=i("7days"),y=i("line"),E=i(""),o=X({start:"",end:""}),N=[{label:"BugÃ¼n",value:"today"},{label:"DÃ¼n",value:"yesterday"},{label:"Son 7 GÃ¼n",value:"7days"},{label:"Son 30 GÃ¼n",value:"30days"},{label:"Bu Ay",value:"thisMonth"},{label:"GeÃ§en Ay",value:"lastMonth"},{label:"Bu YÄ±l",value:"thisYear"}],n=i({totalRevenue:0,totalOrders:0,avgOrderValue:0,conversionRate:0,revenueChange:0,ordersChange:0,avgChange:0,conversionChange:0}),V=i([]),U=i([]),f=i([]),F=i([]),I=i([]),P=i([]),R=i(),x=i(),w=i(),D=i();let C=null,A=null,T=null,M=null;ee(()=>{G()}),K(_,()=>{G()}),K(y,()=>{C&&Z()});const j=r=>{_.value=r},z=()=>{o.start&&o.end&&G()},G=async()=>{try{const r={period:_.value};o.start&&o.end&&(r.start_date=o.start,r.end_date=o.end);const[t,s,l,v,B]=await Promise.all([h.get("/api/admin/reports/metrics",{params:r}),h.get("/api/admin/reports/top-products",{params:r}),h.get("/api/admin/reports/top-sellers",{params:r}),h.get("/api/admin/reports/daily",{params:r}),h.get("/api/admin/reports/summary",{params:r})]);n.value=t.data,V.value=s.data,U.value=l.data,f.value=v.data,F.value=B.data.paymentMethods,I.value=B.data.shippingStatus,P.value=B.data.topCities,await te(),W()}catch(r){console.error("Veri yÃ¼kleme hatasÄ±:",r)}},W=()=>{Y(),q(),H(),J()},Y=()=>{if(!R.value)return;C&&C.destroy();const r=R.value.getContext("2d");if(!r)return;const t=f.value.map(l=>L(l.date)),s=f.value.map(l=>l.revenue);C=new b(r,{type:y.value,data:{labels:t,datasets:[{label:"Gelir (â‚º)",data:s,backgroundColor:"rgba(37, 99, 235, 0.1)",borderColor:"rgb(37, 99, 235)",borderWidth:2,fill:y.value==="area",tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:l=>u(l)}}}}})},Z=()=>{Y()},q=()=>{if(!x.value)return;A&&A.destroy();const r=x.value.getContext("2d");r&&(A=new b(r,{type:"doughnut",data:{labels:["TamamlandÄ±","Ä°ÅŸleniyor","Kargoda","Beklemede","Ä°ptal"],datasets:[{data:[45,25,15,10,5],backgroundColor:["rgb(34, 197, 94)","rgb(59, 130, 246)","rgb(251, 146, 60)","rgb(234, 179, 8)","rgb(239, 68, 68)"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}}))},H=()=>{if(!w.value)return;T&&T.destroy();const r=w.value.getContext("2d");r&&(T=new b(r,{type:"bar",data:{labels:["Elektronik","Giyim","Ev & YaÅŸam","Spor","Kitap"],datasets:[{label:"SatÄ±ÅŸ Adedi",data:[120,95,78,65,45],backgroundColor:"rgba(37, 99, 235, 0.8)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{legend:{display:!1}}}}))},J=()=>{if(!D.value)return;M&&M.destroy();const r=D.value.getContext("2d");if(!r)return;const t=Array.from({length:24},(l,v)=>`${v}:00`),s=[5,3,2,1,2,8,15,25,35,42,48,52,55,58,60,62,65,70,68,55,45,32,20,10];M=new b(r,{type:"line",data:{labels:t,datasets:[{label:"SipariÅŸ SayÄ±sÄ±",data:s,backgroundColor:"rgba(34, 197, 94, 0.1)",borderColor:"rgb(34, 197, 94)",borderWidth:2,fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})},$=async r=>{try{const t={period:_.value,format:r};o.start&&o.end&&(t.start_date=o.start,t.end_date=o.end);const s=await h.get("/api/admin/reports/export",{params:t,responseType:"blob"}),l=window.URL.createObjectURL(new Blob([s.data])),v=document.createElement("a");v.href=l,v.setAttribute("download",`rapor-${Date.now()}.${r==="excel"?"xlsx":"pdf"}`),document.body.appendChild(v),v.click(),v.remove()}catch(t){console.error("Export hatasÄ±:",t),alert("Rapor indirilirken bir hata oluÅŸtu")}},u=r=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:0}).format(r),L=r=>new Date(r).toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric"});return(r,t)=>(c(),d("div",ne,[e("div",le,[t[6]||(t[6]=e("div",null,[e("h1",null,"ðŸ“Š Raporlama & Analitik"),e("p",{class:"subtitle"},"DetaylÄ± satÄ±ÅŸ ve performans raporlarÄ±")],-1)),e("div",oe,[e("button",{onClick:t[0]||(t[0]=s=>$("excel")),class:"btn btn-success"}," ðŸ“¥ Excel Ä°ndir "),e("button",{onClick:t[1]||(t[1]=s=>$("pdf")),class:"btn btn-secondary"}," ðŸ“„ PDF Ä°ndir ")])]),e("div",ie,[(c(),d(m,null,p(N,s=>e("button",{key:s.value,onClick:l=>j(s.value),class:g(["period-btn",{active:_.value===s.value}])},a(s.label),11,de)),64)),e("div",ce,[k(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.start=s),type:"date"},null,512),[[O,o.start]]),t[7]||(t[7]=e("span",null,"â†’",-1)),k(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.end=s),type:"date"},null,512),[[O,o.end]]),e("button",{onClick:z,class:"btn btn-sm btn-primary"},"Uygula")])]),e("div",ue,[e("div",ve,[t[8]||(t[8]=e("div",{class:"metric-header"},[e("span",{class:"metric-icon"},"ðŸ’°"),e("span",{class:"metric-label"},"Toplam Gelir")],-1)),e("div",me,a(u(n.value.totalRevenue)),1),e("div",{class:g(["metric-change",n.value.revenueChange>=0?"positive":"negative"])},[e("span",null,a(n.value.revenueChange>=0?"â†—":"â†˜"),1),S(" "+a(Math.abs(n.value.revenueChange))+"% Ã¶nceki dÃ¶neme gÃ¶re ",1)],2)]),e("div",pe,[t[9]||(t[9]=e("div",{class:"metric-header"},[e("span",{class:"metric-icon"},"ðŸ“¦"),e("span",{class:"metric-label"},"Toplam SipariÅŸ")],-1)),e("div",he,a(n.value.totalOrders.toLocaleString("tr-TR")),1),e("div",{class:g(["metric-change",n.value.ordersChange>=0?"positive":"negative"])},[e("span",null,a(n.value.ordersChange>=0?"â†—":"â†˜"),1),S(" "+a(Math.abs(n.value.ordersChange))+"% Ã¶nceki dÃ¶neme gÃ¶re ",1)],2)]),e("div",ge,[t[10]||(t[10]=e("div",{class:"metric-header"},[e("span",{class:"metric-icon"},"ðŸ›’"),e("span",{class:"metric-label"},"Ortalama Sepet")],-1)),e("div",_e,a(u(n.value.avgOrderValue)),1),e("div",{class:g(["metric-change",n.value.avgChange>=0?"positive":"negative"])},[e("span",null,a(n.value.avgChange>=0?"â†—":"â†˜"),1),S(" "+a(Math.abs(n.value.avgChange))+"% Ã¶nceki dÃ¶neme gÃ¶re ",1)],2)]),e("div",ye,[t[11]||(t[11]=e("div",{class:"metric-header"},[e("span",{class:"metric-icon"},"ðŸ“ˆ"),e("span",{class:"metric-label"},"DÃ¶nÃ¼ÅŸÃ¼m OranÄ±")],-1)),e("div",be,a(n.value.conversionRate.toFixed(2))+"%",1),e("div",{class:g(["metric-change",n.value.conversionChange>=0?"positive":"negative"])},[e("span",null,a(n.value.conversionChange>=0?"â†—":"â†˜"),1),S(" "+a(Math.abs(n.value.conversionChange))+"% Ã¶nceki dÃ¶neme gÃ¶re ",1)],2)])]),e("div",fe,[e("div",Ce,[e("div",ke,[t[13]||(t[13]=e("h3",null,"ðŸ’¹ Gelir Trendi",-1)),k(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>y.value=s),class:"chart-type-selector"},[...t[12]||(t[12]=[e("option",{value:"line"},"Ã‡izgi",-1),e("option",{value:"bar"},"Bar",-1),e("option",{value:"area"},"Alan",-1)])],512),[[se,y.value]])]),e("div",Se,[e("canvas",{ref_key:"revenueChart",ref:R},null,512)])]),e("div",Re,[t[14]||(t[14]=e("div",{class:"chart-header"},[e("h3",null,"ðŸ“Š SipariÅŸ Durumu")],-1)),e("div",xe,[e("canvas",{ref_key:"orderStatusChart",ref:x},null,512)])])]),e("div",we,[e("div",De,[t[15]||(t[15]=e("div",{class:"chart-header"},[e("h3",null,"ðŸ† En Ã‡ok Satan Kategoriler")],-1)),e("div",Ae,[e("canvas",{ref_key:"categoryChart",ref:w},null,512)])]),e("div",Te,[t[16]||(t[16]=e("div",{class:"chart-header"},[e("h3",null,"â° Saatlik SatÄ±ÅŸ DaÄŸÄ±lÄ±mÄ±")],-1)),e("div",Me,[e("canvas",{ref_key:"hourlyChart",ref:D},null,512)])])]),e("div",Ge,[e("div",Be,[t[19]||(t[19]=e("h3",null,"ðŸ… En Ã‡ok Satan ÃœrÃ¼nler",-1)),e("div",Oe,[(c(!0),d(m,null,p(V.value,(s,l)=>(c(),d("div",{key:s.id,class:"performer-item"},[e("div",Ee,a(l+1),1),e("div",Ve,[e("strong",null,a(s.name),1),e("small",null,a(s.category),1)]),e("div",Ue,[e("div",Fe,[t[17]||(t[17]=e("label",null,"SatÄ±ÅŸ",-1)),e("strong",null,a(s.sales),1)]),e("div",Ie,[t[18]||(t[18]=e("label",null,"Gelir",-1)),e("strong",null,a(u(s.revenue)),1)])])]))),128))])]),e("div",Pe,[t[22]||(t[22]=e("h3",null,"ðŸ‘¥ En Ã‡ok SatÄ±ÅŸ Yapan SatÄ±cÄ±lar",-1)),e("div",Ye,[(c(!0),d(m,null,p(U.value,(s,l)=>(c(),d("div",{key:s.id,class:"performer-item"},[e("div",$e,a(l+1),1),e("div",Le,[e("strong",null,a(s.name),1),e("small",null,a(s.email),1)]),e("div",Ke,[e("div",Ne,[t[20]||(t[20]=e("label",null,"SipariÅŸ",-1)),e("strong",null,a(s.orders),1)]),e("div",je,[t[21]||(t[21]=e("label",null,"Gelir",-1)),e("strong",null,a(u(s.revenue)),1)])])]))),128))])])]),e("div",ze,[e("div",We,[e("div",Ze,[t[23]||(t[23]=e("h3",null,"ðŸ“… GÃ¼nlÃ¼k Detay",-1)),e("div",qe,[k(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>E.value=s),type:"text",placeholder:"Ara..."},null,512),[[O,E.value]])])]),e("div",He,[e("table",null,[t[24]||(t[24]=e("thead",null,[e("tr",null,[e("th",null,"Tarih"),e("th",null,"SipariÅŸ"),e("th",null,"Gelir"),e("th",null,"Ort. Sepet"),e("th",null,"MÃ¼ÅŸteri"),e("th",null,"Trend")])],-1)),e("tbody",null,[(c(!0),d(m,null,p(f.value,s=>(c(),d("tr",{key:s.date},[e("td",null,a(L(s.date)),1),e("td",null,a(s.orders),1),e("td",null,a(u(s.revenue)),1),e("td",null,a(u(s.avgOrder)),1),e("td",null,a(s.customers),1),e("td",null,[e("span",{class:g(["trend",s.trend>=0?"up":"down"])},a(s.trend>=0?"â†—":"â†˜")+" "+a(Math.abs(s.trend))+"% ",3)])]))),128))])])])])]),e("div",Je,[e("div",Qe,[t[25]||(t[25]=e("h4",null,"ðŸ’³ Ã–deme YÃ¶ntemleri",-1)),e("div",Xe,[(c(!0),d(m,null,p(F.value,s=>(c(),d("div",{key:s.method,class:"summary-item"},[e("span",et,a(s.method),1),e("span",tt,a(u(s.amount)),1),e("span",st,a(s.percent)+"%",1)]))),128))])]),e("div",at,[t[26]||(t[26]=e("h4",null,"ðŸšš Kargo Durumu",-1)),e("div",rt,[(c(!0),d(m,null,p(I.value,s=>(c(),d("div",{key:s.status,class:"summary-item"},[e("span",nt,a(s.status),1),e("span",lt,a(s.count)+" sipariÅŸ",1),e("span",ot,a(s.percent)+"%",1)]))),128))])]),e("div",it,[t[27]||(t[27]=e("h4",null,"ðŸŒ Åžehir DaÄŸÄ±lÄ±mÄ±",-1)),e("div",dt,[(c(!0),d(m,null,p(P.value,s=>(c(),d("div",{key:s.name,class:"summary-item"},[e("span",ct,a(s.name),1),e("span",ut,a(u(s.revenue)),1),e("span",vt,a(s.percent)+"%",1)]))),128))])])])]))}}),yt=re(mt,[["__scopeId","data-v-56a7d108"]]);export{yt as default};
