import{d as S,u as z,r as d,E as i,b as A,e as r,f as n,g as o,h as p,z as E,m as M,t as v,q as h,v as k,n as x,j as f,p as V,i as C,w as N,D as y}from"./index-D2hY-dD-.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const B={class:"login max-w-md mx-auto p-8 bg-white rounded-lg shadow mt-10"},I={key:0,class:"bg-blue-50 border border-blue-200 text-blue-800 p-4 rounded-lg mb-4 text-sm"},L={key:1,class:"bg-red-100 text-red-700 p-3 rounded mb-4"},D={key:0,class:"text-red-500 text-sm mt-1"},G={key:0,class:"text-red-500 text-sm mt-1"},q=["disabled"],O={key:0,class:"flex items-center justify-center gap-2"},T={key:1},U={class:"mt-4 text-center text-sm text-slate-600"},j=S({__name:"Login",setup(H){const u=z(),s=d(""),l=d(""),c=d(""),m=d(!1),t=d({});i.autoDetectMockAuth();function w(){t.value={};let e=!0;return!s.value||s.value.trim().length===0?(t.value.email="Email adresi zorunludur",e=!1):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.value)||(t.value.email="GeÃ§erli bir email adresi girin",e=!1),!l.value||l.value.length===0?(t.value.password="Åifre zorunludur",e=!1):l.value.length<6&&(t.value.password="Åifre en az 6 karakter olmalÄ±dÄ±r",e=!1),e}async function _(){if(c.value="",!!w()){m.value=!0;try{let e;if(i.isMockAuthEnabled())console.log("ğŸ­ Using Mock Auth"),e={data:await i.mockLogin(s.value,l.value)};else try{e=await y.post("/api/login",{email:s.value,password:l.value})}catch(a){if(a.code==="ERR_NETWORK"||a.message==="Network Error")console.warn("âš ï¸ Backend not available, falling back to mock auth"),i.enableMockAuth(),e={data:await i.mockLogin(s.value,l.value)};else throw a}console.log("âœ… Login Success:",e.data),localStorage.setItem("token",e.data.token),localStorage.setItem("role",e.data.user.role),localStorage.setItem("user",JSON.stringify(e.data.user)),console.log("ğŸ’¾ Saved to localStorage:",{token:localStorage.getItem("token"),role:localStorage.getItem("role"),user:localStorage.getItem("user")}),y.defaults.headers.common.Authorization=`Bearer ${e.data.token}`,e.data.user.role==="admin"?(console.log("ğŸ”„ Redirecting to /admin/dashboard"),u.push("/admin/dashboard")):e.data.user.role==="seller"?(console.log("ğŸ”„ Redirecting to /seller/dashboard"),u.push("/seller/dashboard")):e.data.user.role==="buyer"?(console.log("ğŸ”„ Redirecting to /buyer/dashboard"),u.push("/buyer/dashboard")):(console.log("ğŸ”„ Redirecting to /"),u.push("/"))}catch(e){console.error("âŒ Login error:",e),c.value=e.message||e.response?.data?.message||"GiriÅŸ baÅŸarÄ±sÄ±z. LÃ¼tfen bilgilerinizi kontrol edin."}finally{m.value=!1}}}return(e,a)=>{const g=A("router-link");return n(),r("div",B,[a[6]||(a[6]=o("h2",{class:"text-2xl font-bold mb-6"},"GiriÅŸ Yap",-1)),E(i).isMockAuthEnabled()?(n(),r("div",I,[...a[2]||(a[2]=[M('<div class="flex items-start gap-2" data-v-815beefe><span class="text-lg" data-v-815beefe>ğŸ­</span><div data-v-815beefe><p class="font-semibold mb-2" data-v-815beefe>Demo Mod Aktif</p><p class="text-xs text-blue-700 mb-2" data-v-815beefe>Backend baÄŸlantÄ±sÄ± yok, test hesaplarÄ± kullanÄ±lÄ±yor:</p><div class="space-y-1 text-xs font-mono bg-blue-100 p-2 rounded" data-v-815beefe><p data-v-815beefe><strong data-v-815beefe>Admin:</strong> admin@sportoonline.com / admin123</p><p data-v-815beefe><strong data-v-815beefe>SatÄ±cÄ±:</strong> seller@sportoonline.com / seller123</p><p data-v-815beefe><strong data-v-815beefe>AlÄ±cÄ±:</strong> buyer@sportoonline.com / buyer123</p></div></div></div>',1)])])):p("",!0),c.value?(n(),r("div",L,v(c.value),1)):p("",!0),o("form",{onSubmit:V(_,["prevent"]),class:"space-y-4"},[o("div",null,[h(o("input",{"onUpdate:modelValue":a[0]||(a[0]=b=>s.value=b),placeholder:"Email",type:"email",required:"",autocomplete:"username",class:x(["w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":t.value?.email}])},null,2),[[k,s.value]]),t.value?.email?(n(),r("p",D,v(t.value.email),1)):p("",!0)]),o("div",null,[h(o("input",{"onUpdate:modelValue":a[1]||(a[1]=b=>l.value=b),placeholder:"Åifre",type:"password",required:"",autocomplete:"current-password",class:x(["w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":t.value?.password}])},null,2),[[k,l.value]]),t.value?.password?(n(),r("p",G,v(t.value.password),1)):p("",!0)]),o("button",{type:"submit",disabled:m.value,class:"w-full py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 transition-colors"},[m.value?(n(),r("span",O,[...a[3]||(a[3]=[o("svg",{class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),f(" GiriÅŸ yapÄ±lÄ±yor... ",-1)])])):(n(),r("span",T,"GiriÅŸ"))],8,q)],32),o("div",U,[a[5]||(a[5]=f(" HesabÄ±nÄ±z yok mu? ",-1)),C(g,{to:"/register",class:"text-blue-600 hover:text-blue-700 font-medium"},{default:N(()=>[...a[4]||(a[4]=[f("KayÄ±t Ol",-1)])]),_:1})])])}}}),F=R(j,[["__scopeId","data-v-815beefe"]]);export{F as default};
