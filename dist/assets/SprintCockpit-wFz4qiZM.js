import{r as h,d as z,c as $,o as N,a as R,e as n,f as r,h as b,g as o,i as T,as as q,t as f,z as I,j as A,at as H,F as K,k as U,M as Y,D as j}from"./index-BGyiXXhD.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";function G(w={}){const{placeholder:t='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300"%3E%3Crect fill="%23e2e8f0" width="400" height="300"/%3E%3C/svg%3E',fallback:c='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300"%3E%3Crect fill="%23e2e8f0" width="400" height="300"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" fill="%2394a3b8" font-size="16"%3EG√∂rsel Y√ºklenemedi%3C/text%3E%3C/svg%3E',lazy:i=!0}=w,d=s=>new Promise((a,_)=>{const p=new Image;p.onload=()=>a(s),p.onerror=()=>_(new Error("Image load failed")),p.src=s});return{createImageRef:(s="")=>{const a=h(t),_=h(!1),p=h(!1),m=async v=>{if(!v){a.value=t;return}_.value=!0,p.value=!1,a.value=t;try{await d(v),a.value=v}catch{p.value=!0,a.value=c}finally{_.value=!1}};return s&&!i&&m(s),{src:a,isLoading:_,hasError:p,load:m}},loadImage:d}}const W={class:"card"},J={key:0,class:"campaign-badge"},O={class:"badge-text"},Q={key:1,class:"countdown-timer"},X={class:"card-image"},Z={key:0},ee=["srcset"],te=["src","alt","srcset"],ae={key:1,class:"skeleton-loader"},se={key:2,class:"error-placeholder"},oe={class:"price-section"},re={key:0,class:"discounted-price"},ne={class:"old-price"},ce={class:"new-price"},ie={key:1,class:"regular-price"},le=z({__name:"ProductCard",props:{product:{}},emits:["add-to-cart"],setup(w){const t=w,c=$(()=>t.product.image_url||t.product.image),{imageSrc:i,imageState:d,load:l}=G(c.value),s=$(()=>{const e=i&&i.value?i.value:"";if(!e)return"";const u=y=>y.match(/(.+)\.(jpg|jpeg|png|webp)(?:[?#].*)?$/i)?y.replace(/\.(jpg|jpeg|png|webp)(?:$|(?=[?#]))/i,".webp"):y+".webp",g=(y,S,V=!1)=>{const[D,F]=y.split("?"),L=V?u(D):D,M=F?`?${F}`:"";return S?`${L}${M}${M?"&":"?"}w=${S}`:`${L}${M}`},C=g(e,400,!0),k=g(e,800,!0),x=g(e,1200,!0);return`${C} 400w, ${k} 800w, ${x} 1200w`}),a=$(()=>t.product.active_campaign),_=$(()=>{if(!a.value)return t.product.price;const e=a.value;return e.type==="percentage"?t.product.price*(1-e.discount_value/100):e.type==="fixed"?Math.max(0,t.product.price-e.discount_value):t.product.price}),p=$(()=>{if(!a.value)return"";const e=a.value;return e.type==="percentage"?`%${e.discount_value} ƒ∞ndirim`:e.type==="fixed"?`‚Ç∫${e.discount_value} ƒ∞ndirim`:"Kampanya"}),m=h("");let v=null;const E=()=>{if(!a.value)return;const e=new Date(a.value.end_date),u=new Date,g=e.getTime()-u.getTime();if(g<=0){m.value="",v&&clearInterval(v);return}const C=Math.floor(g/(1e3*60*60*24)),k=Math.floor(g%(1e3*60*60*24)/(1e3*60*60)),x=Math.floor(g%(1e3*60*60)/(1e3*60));C>0?m.value=`${C}g ${k}s kaldƒ±`:k>0?m.value=`${k}s ${x}dk kaldƒ±`:m.value=`${x}dk kaldƒ±`};N(()=>{l(),a.value&&(E(),v=window.setInterval(E,6e4))}),R(()=>{v&&clearInterval(v)});const P=e=>new Intl.NumberFormat("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e);return(e,u)=>(r(),n("div",W,[a.value?(r(),n("div",J,[T(q,{cls:"w-4 h-4 text-white"}),o("span",O,f(p.value),1)])):b("",!0),a.value&&m.value?(r(),n("div",Q,f(m.value),1)):b("",!0),o("div",X,[I(d)==="loaded"?(r(),n("picture",Z,[o("source",{srcset:s.value,type:"image/webp"},null,8,ee),o("img",{src:I(i),alt:e.product.name,loading:"lazy",decoding:"async",srcset:s.value,sizes:"(max-width: 640px) 100vw, 33vw"},null,8,te)])):I(d)==="loading"?(r(),n("div",ae)):I(d)==="error"?(r(),n("div",se,[...u[1]||(u[1]=[o("svg",{class:"w-12 h-12 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])])):b("",!0)]),o("h3",null,f(e.product.name),1),o("div",oe,[a.value?(r(),n("div",re,[o("span",ne,"‚Ç∫"+f(P(e.product.price)),1),o("span",ce,"‚Ç∫"+f(P(_.value)),1)])):(r(),n("p",ie,"‚Ç∫"+f(P(e.product.price)),1))]),o("button",{onClick:u[0]||(u[0]=g=>e.$emit("add-to-cart",e.product)),class:"add-to-cart-btn"},[T(H,{cls:"w-5 h-5 inline-block mr-2 text-white"}),u[2]||(u[2]=A(" Sepete Ekle ",-1))])]))}}),de=B(le,[["__scopeId","data-v-e3972de0"]]),ue={class:"product-list"},pe=z({__name:"ProductList",props:{products:{}},emits:["add-to-cart"],setup(w){return(t,c)=>(r(),n("div",ue,[(r(!0),n(K,null,U(t.products,i=>(r(),Y(de,{key:i.id,product:i,onAddToCart:c[0]||(c[0]=d=>t.$emit("add-to-cart",d))},null,8,["product"]))),128))]))}}),me=B(pe,[["__scopeId","data-v-661dd37a"]]),ve={class:"cockpit-container"},ge={class:"products-section"},_e={key:0,class:"loading"},fe={key:1,class:"no-products"},he=z({__name:"SprintCockpit",setup(w){const t=h([]),c=h(!1),i=async()=>{c.value=!0;try{const{data:l}=await j.get("/api/products");t.value=l.products?.data||l.products||[]}catch(l){console.error("Failed to load products:",l)}finally{c.value=!1}},d=async l=>{try{await j.post("/api/cart",{product_id:l.id,quantity:1}),alert(`${l.name} sepete eklendi!`)}catch(s){console.error("Failed to add to cart:",s),alert("Sepete eklenirken bir hata olu≈ütu")}};return N(()=>{i()}),(l,s)=>(r(),n("div",ve,[s[1]||(s[1]=o("h2",null,"üèÅ Sprint Cockpit - Kampanyalƒ± √úr√ºnler",-1)),o("section",ge,[s[0]||(s[0]=o("h3",null,"√úr√ºnler",-1)),T(me,{products:t.value,onAddToCart:d},null,8,["products"]),c.value?(r(),n("div",_e,"Y√ºkleniyor...")):b("",!0),!c.value&&t.value.length===0?(r(),n("div",fe," Hen√ºz √ºr√ºn bulunmuyor. ")):b("",!0)])]))}}),$e=B(he,[["__scopeId","data-v-c3bbfeb4"]]);export{$e as default};
